var wma_highzoom_activated=!0,wma_highzoom_purge=!1,wma_bldg3dzoom=14,bldg3d=null,bldg3dc=null,bldg3dtimer=null,update3dBuildings,credit,wmaNews=[],wma_imgbase="tiles/",wma_database="label.php",wma_tilebase=".wma.wmflabs.org/tiles/",wma_maxlabel=13,i,wma_zoomsize=[3];for(i=1;40>i;i++)wma_zoomsize[i]=2*wma_zoomsize[i-1];
var lc={},wma_tilesets=[{name:"mapFull",globe:"Earth",credit:' / Map data \u00a9 <a href="http://www.openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://www.opendatacommons.org/licenses/odbl">License</a>',getTileURL:function(n,e,h,N){me=wma_tilesets[0];return N||"https:"==document.location.protocol?7<=h?wma_imgbase+"mapnik/"+h+"/"+n+"/tile_"+n+"_"+e%(2*wma_zoomsize[h])+".png":wma_imgbase+"mapnik/"+h+"/tile_"+n+"_"+e%(2*wma_zoomsize[h])+".png":7<=h?"//"+(e+n)%8+wma_tilebase+"mapnik/"+
h+"/"+n+"/tile_"+n+"_"+e%(2*wma_zoomsize[h])+".png":"//"+(e+n)%8+wma_tilebase+"mapnik/"+h+"/tile_"+n+"_"+e%(2*wma_zoomsize[h])+".png"},linkcolor:["#2255aa","1px 0px 2px white, 0px -1px 2px white, 0px 1px 2px white, -1px 0px 2px white"],equator:40075,maxzoom:20,minzoom:0},{name:"mapPhysical",globe:"Earth",getTileURL:function(n,e,h){return wma_imgbase+"relief/"+h+"/"+n+"_"+e%(2*wma_zoomsize[h])+".png"},linkcolor:["#2255aa","white 0pt 0pt 2pt"],equator:40075,maxzoom:5,minzoom:0},{name:"mapLandsat",globe:"Earth",
getTileURL:function(n,e,h,N){e%=2*wma_zoomsize[h];0>e&&(e+=2*wma_zoomsize[h]);return N||"https:"==document.location.protocol?wma_imgbase+"mapnik/sat/"+h+"/"+n+"/"+n+"_"+e%(2*wma_zoomsize[h])+".png":"//"+(e+n)%8+wma_tilebase+"mapnik/sat/"+h+"/"+n+"/"+n+"_"+e%(2*wma_zoomsize[h])+".png"},linkcolor:["white","black 0pt 0pt 2pt"],equator:40075,maxzoom:13,minzoom:0},{name:"mapCoastline",globe:"Earth",getTileURL:function(n,e,h){return wma_imgbase+"plain/"+h+"/tile_"+n+"_"+e%(2*wma_zoomsize[h])+".png"},linkcolor:["#2255aa",
"1px 0px 2px white, 0px -1px 2px white, 0px 1px 2px white, -1px 0px 2px white"],equator:40075,maxzoom:7,minzoom:0},{name:"mapPhysical",globe:"Moon",getTileURL:function(n,e,h){e%=2*wma_zoomsize[h];0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"lro_moon/lromoon_00"+(5-h)+"_"+("000"+e).substr(-3)+"_"+("000"+n).substr(-3)+".png"},linkcolor:["black","1px 0px 2px white, 0px -1px 2px white, 0px 1px 2px white, -1px 0px 2px white"],equator:10940.475,maxzoom:5,minzoom:0},{name:"mapLandsat",globe:"Moon",getTileURL:function(n,
e,h){e%=2*wma_zoomsize[h];0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"moon/"+h+"/"+n+"_"+e+".jpg"},linkcolor:["white","1px 0px 2px black, 0px -1px 2px black, 0px 1px 2px black, -1px 0px 2px black"],equator:10940.475,maxzoom:7,minzoom:0},{name:"mapLandsat",globe:"Mars",getTileURL:function(n,e,h){e=(e+wma_zoomsize[h])%(2*wma_zoomsize[h]);0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"mars/mars_00"+(5-h)+"_"+("000"+e).substr(-3)+"_"+("000"+n).substr(-3)+".png"},linkcolor:["white","black 0pt 0pt 2pt"],
equator:21359.975,maxzoom:5,minzoom:0},{name:"mapPhysical",globe:"Venus",getTileURL:function(n,e,h){e%=2*wma_zoomsize[h];0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"venus/venus_00"+(3-h)+"_"+("000"+e).substr(-3)+"_"+("000"+n).substr(-3)+".png"},linkcolor:["white","1px 0px 2px black, 0px -1px 2px black, 0px 1px 2px black, -1px 0px 2px black"],equator:38024.6,maxzoom:3,minzoom:0},{name:"mapLandsat",globe:"Mercury",getTileURL:function(n,e,h){e=(e+1*wma_zoomsize[h])%(2*wma_zoomsize[h]);0>e&&(e+=2*
wma_zoomsize[h]);h=6-h;return wma_imgbase+"mercury/"+(3>h?h+"/":"")+(0==h?Math.floor(e/100)+"/":"")+"merc_00"+h+"_"+("000"+e).substr(-3)+"_"+("000"+n).substr(-3)+".png"},linkcolor:["white","1px 0px 2px black, 0px -1px 2px black, 0px 1px 2px black, -1px 0px 2px black"],equator:15329.1,maxzoom:6,minzoom:0},{name:"mapLandsat",globe:"Io",getTileURL:function(n,e,h){e=(e+wma_zoomsize[h])%(2*wma_zoomsize[h]);0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"io/io_00"+(4-h)+"_"+("000"+e).substr(-3)+"_"+("000"+
n).substr(-3)+".png"},linkcolor:["black","1px 0px 2px white, 0px -1px 2px white, 0px 1px 2px white, -1px 0px 2px white"],equator:11443.6,maxzoom:4,minzoom:0},{name:"mapLandsat",globe:"Titan",getTileURL:function(n,e,h){e%=2*wma_zoomsize[h];0>e&&(e+=2*wma_zoomsize[h]);return wma_imgbase+"titan/titan_00"+(3-h)+"_"+("000"+e).substr(-3)+"_"+("000"+n).substr(-3)+".png"},linkcolor:["black","1px 0px 2px white, 0px -1px 2px white, 0px 1px 2px white, -1px 0px 2px white"],equator:16190.3,maxzoom:3,minzoom:0}];
function parseParams(n){var e={},h,N=n.substr(n.indexOf("?")+1).split("&");for(h=0;h<N.length;++h)n=N[h].split("="),e[n[0]]=n[1];return e}function isRTL(n){return 0<=$.inArray(n,["ar","he","fa"])}
function wikiminiatlasInstall(n,e){function h(){xa.style.visibility="visible"!=xa.style.visibility?"visible":"hidden";return!1}function N(){var a=$("<div></div>").addClass("wmatile").on("mousedown touchstart",Sa).click(function(c){var f=ta(c);if(f.x!=pa.x||f.y!=pa.y||!b.csrender)return!0;(c=wmajt.detectPointer(c,b))&&fb(c)}),b={div:a,img:$("<img>").load(function(c){$(this).fadeIn(100)}).error(function(c){setTimeout(function(){var f=b.img.attr("src");b.img.attr("src",f.replace(/\?.*/,"")+"?"+Math.random())},
1E3)}).css({width:"128px",height:"128px"}).appendTo(a),can:$("<canvas></canvas>").appendTo(a),ctx:null,csrender:!1,csx:0,csy:0,csz:20,lx:0,ly:0,lz:20,span:$("<span></span>").appendTo(a),debug:$("<span></span>").addClass("wmadbg").css("display","none").appendTo(a),url:"",xhr:null};X&&(1<L?(b.can.attr({width:128*L,height:128*L}).css({width:"128px",height:"128px"}),b.ctx=b.can[0].getContext("2d"),b.ctx.scale(L,L)):(b.can.attr({width:128,height:128}),b.ctx=b.can[0].getContext("2d")));$(fa).append(b.div);
return b}function S(){var a,b;if(null===fa){$(document).on("mousemove touchmove",function(c){window.scrollTo(0,0);var f=ta(c);null!==ua&&(D-=f.x-ua.x,G-=f.y-ua.y,ua=f,O(),aa&&(aa=!1,ya()));H.shown&&Ha(ba(D+f.x,G+f.y));f=ba(D+F/2,G+E/2);B&&B.setLatLon(f.lat,f.lon);c.preventDefault()}).on("mouseup touchend",function(){ua=null});$("#wma_map").on("dblclick",gb).on("mousedown touchstart",Sa);fa=document.getElementById("wma_map");ha=Math.floor(F/128)+2;ma=Math.floor(E/128)+2;ia=[];for(b=0;b<ma;++b)for(a=
0;a<ha;++a)ia.push(N());P.obj=$('<div id="wmamarker"></div>');$(fa).append(P.obj)}}function na(){var a=$(window).width(),b=$(window).height(),c=Math.floor(a/128)+2,f=Math.floor(b/128)+2,k;F=a;E=b;X&&(null!==z.canvas&&(z.canvas.attr({width:a*L,height:b*L}).css({width:a+"px",height:b+"px"}),z.c.setTransform(L,0,0,L,0,0)),bldg3d.attr({width:a*L,height:b*L}).css({width:a+"px",height:b+"px"}),bldg3dc.viewport&&bldg3dc.viewport(0,0,a*L,b*L));if(c!=ha||f!=ma){ha=c;for(ma=f;ia.length<c*f;)ia.push(N());for(k=
0;k<ia.length;++k)k<c*f?ia[k].div.show():ia[k].div.hide();O();$(fa).width(a).height(b)}else z.shown&&ja()}function T(){z.shown?z.canvas.fadeOut(200):z.canvas.fadeIn(200);z.shown=!z.shown}function Ha(a){function b(x){var u;if(0<x.length){var v=x[0].lat+a.lat;v=za(v,x[0].lon/Math.cos(v/180*Math.PI)+a.lon);k.moveTo(v.x-d,v.y-g);for(u=1;u<x.length;++u)v=x[u].lat+a.lat,v=za(v,x[u].lon/Math.cos(v/180*Math.PI)+a.lon),k.lineTo(v.x-d,v.y-g)}}var c,f,k=H.c,w=H.ways,m=H.areas,d=D,g=G;if(null!==k){k.clearRect(0,
0,H.canvas[0].width,H.canvas[0].height);if(null!==m)for(k.fillStyle="rgb(0, 255, 0)",c=0;c<m.length;c++){k.globalCompositeOperation="source-over";for(f=0;f<m[c].outer.length;++f)k.beginPath(),b(m[c].outer[f]),k.closePath(),k.fill();k.globalCompositeOperation="destination-out";for(f=0;f<m[c].inner.length;++f)k.beginPath(),b(m[c].inner[f]),k.closePath(),k.fill()}if(null!==w){k.globalCompositeOperation="source-over";k.lineWidth=4;k.strokeStyle="rgb(0, 255, 0)";k.beginPath();for(c=0;c<w.length;++c)b(w[c]);
k.stroke()}}}function ja(a,b,c,f,k,w){function m(p){var l,q=0;p[0].lon<z.minlon&&(q=2*a);if(0<p.length){var I=za(p[0].lat,p[0].lon,a);var J=I.x;w.moveTo(I.x-x+q,I.y-c);for(l=1;l<p.length;++l)I=ka(p[l].lat,p[l].lon,a),J=I.x-J,Math.abs(J)>a&&(q-=2*Math.round(J/(2*a))*a),J=I.x,w.lineTo(I.x-x+q,I.y-c)}}var d=z.ways,g=z.areas;a=a||128*wma_zoomsize[A];b=void 0!==b?b:D;c=void 0!==c?c:G;w=w||z.c;var x=b;if(null!==w)for(f=f||z.canvas[0].width,k=k||z.canvas[0].height,w.clearRect(0,0,f,k),k=-2;2>=k;++k){x=b+
2*k*a;var u=za(0,z.minlon,a);var v=za(0,z.maxlon,a);if(!(0>v.x-x||u.x-x>f)){if(null!==g)for(w.fillStyle="rgb(255, 0, 0)",w.strokeStyle="rgb(0, 0, 0)",w.lineWidth=2,u=0;u<g.length;++u){w.globalCompositeOperation="source-over";for(v=0;v<g[u].outer.length;++v)w.beginPath(),m(g[u].outer[v]),w.closePath(),w.fill(),w.stroke();w.globalCompositeOperation="destination-out";for(v=0;v<g[u].inner.length;++v)w.beginPath(),m(g[u].inner[v]),w.closePath(),w.fill(),w.stroke()}if(null!==d){w.globalCompositeOperation=
"source-over";w.lineWidth=4;w.strokeStyle="rgb(0, 0, 255)";w.beginPath();for(u=0;u<d.length;++u)m(d[u]);w.stroke()}}}}function O(){function a(J,t){function ca(da,U,Aa,Ia,Ja){da.click(function(Ba){var V=ta(Ba);if(V.x!=pa.x||V.y!=pa.y)Ba.preventDefault();else if(1==Ba.which&&!Ba.ctrlKey){null==Y.panel&&hb();var qa=F-30,Ta=E-80;V=Aa;var Ea=Ia;V>qa&&(Ea=Math.round(Ea*qa/V),V=qa);Ea>Ta&&(V=Math.round(V*Ta/Ea));Y.span.find("img").remove();qa=$("<img/>",{id:"wma_wmaci_image"}).appendTo(Y.span);2*V<Aa?qa.attr({src:Ca(U,
10*Math.floor(V/10),Ja),srcset:Ca(U,20*Math.floor(V/10),Ja)+" 2x"}):V<Aa?qa.attr({src:Ca(U,10*Math.floor(V/10),Ja)}):qa.attr("src","//commons.wikimedia.org/wiki/Special:FilePath/"+U);Y.link.attr("href","//commons.wikimedia.org/wiki/File:"+U).text("[[:commons:File:"+decodeURIComponent(U)+"]]");Y.panel.fadeIn(200);Y.shown=!0;Ba.preventDefault()}}).attr("href","https://commons.wikimedia.org/wiki/File:"+U)}var y,ea=[0,0,5,0,0,2,3,4,5,6,6],ra=[0,0,8,0,0,2,3,4,5,6,6];J.text("");for(y=0;y<t.length;++y){var K=
$("<a></a>");if(!(8>=A&&!t[y].lang&&t[y].wg<wma_median_weights.commons[A])){if("img"in t[y]){ca(K,t[y].img,t[y].w,t[y].h,t[y].m5);var Q=parseInt(t[y].w)>parseInt(t[y].h)?-2==t[y].style?24:48:Math.floor((-2==t[y].style?24:48)*t[y].w/t[y].h);var la=Math.floor(Q/t[y].w*t[y].h);K.addClass("cthumb").append($("<img/>",{title:decodeURIComponent(t[y].img)}).error(function(){$(this).parent().hide()}).attr({src:Ca(t[y].img,Q,t[y].m5),srcset:2*Q<=t[y].w?Ca(t[y].img,2*Q,t[y].m5)+" 2x":""}).css({width:Q+"px",
height:la+"px"}));18>t[y].head?(K.addClass("dir dir"+t[y].head),Q=8):Q=6;K.css({top:t[y].ty-Q+"px",left:t[y].tx-Q+"px"})}else K.addClass("label").addClass("label"+t[y].style).addClass("label-"+t[y].lang).css(Ka).attr({href:"https://"+t[y].lang+".wikipedia.org/wiki/"+t[y].page,target:"_top"}).css({top:t[y].ty-ra[t[y].style]+"px",left:t[y].tx-ea[t[y].style]+"px",direction:isRTL(t[y].lang)?"rtl":"ltr"}),(Q=/(.*?)(\s*\([^\)]*\)$|\s*, [^, \(]*$)/.exec(t[y].name))?K.text(Q[1]).append($('<span class="hell">&hellip;</span>')).append($('<span class="sufx"></span>').text(Q[2]).hide()).hover(function(){$(".hell",
this).hide();$(".sufx",this).show()},function(){$(".hell",this).show();$(".sufx",this).hide()}):K.text(t[y].name);J.append(K)}}}function b(J,t){var ca=J.lx,y=J.ly,ea=1<<J.lz-wma_maxlabel,ra=[],K,Q=[[],[],[],[]];for(K=0;K<t.length;++K){var la=128*(ca/ea-t[K].dx);var da=128*(y/ea-(wma_zoomsize[wma_maxlabel]-t[K].dy-1));la=(t[K].tx+t[K].fx-la)*ea;var U=(t[K].ty+t[K].fy-da)*ea;0<=la&&128>la&&0<=U&&128>U&&(da=jQuery.extend(!0,{},t[K]),da.tx=Math.floor(la),da.ty=Math.floor(U),da.fx=la-da.tx,da.fy=U-da.ty,
Q[Math.floor(la/64)+2*Math.floor(U/64)].push(da))}for(K=0;4>K;++K)0<Q[K].length&&(Q[K].sort((Aa,Ia)=>Ia.wg-Aa.wg),ra.push(Q[K][0]));a(J.span,ra)}0>G&&(G=0);0>D&&(D+=Math.floor(256*wma_zoomsize[A]));0<D&&(D%=Math.floor(256*wma_zoomsize[A]));var c=Math.floor(D/128)%ha,f=Math.floor(G/128)%ma,k=D%128,w=G%128,m,d,g;ib();for(d=0;d<ma;d++)for(m=0;m<ha;m++){var x=(m+c)%ha+(d+f)%ma*ha;var u=Math.floor(D/128)+m;var v=Math.floor(G/128)+d;var p=wma_tilesets[M].getTileURL(v,u,A);var l=ia[x];l.div.css({left:128*
m-k+"px",top:128*d-w+"px"});if(l.url!=p||wma_highzoom_purge){l.url=p;if(0==M&&12<A){if(l.csrender||(l.csrender=!0,l.img.fadeOut(200)),l.csx!=u||l.csy!=v||l.csz!=A||wma_highzoom_purge)l.can.hide(),l.img.hide(),wmajt.update(u,v,A,l,wma_highzoom_purge)}else{l.csz=A;l.csrender&&l.can.fadeOut(200);if(v>=wma_zoomsize[A]){l.img.fadeOut(0);l.span.text("");continue}l.img.attr("src")!=p?l.img.fadeOut(0).attr("src",p):l.csrender&&l.img.fadeIn(200);l.csrender=!1}null!==l.xhr&&l.xhr.abort();l.lx=u;l.ly=v;l.lz=
A;l.span.html('<span class="loading">'+strings.labelLoading[C]+"</span>");if(A>wma_maxlabel){var q=Math.floor(u/(1<<A-wma_maxlabel));p=Math.floor(v/(1<<A-wma_maxlabel));x=Ua(p,q,wma_maxlabel);p=La(p,q,wma_maxlabel)}else x=Ua(v,u,A),p=La(v,u,A);if(!lc[p]||"filler"in lc[p]){if(lc[p]&&"filler"in lc[p])a(l.span,lc[p].label);else if(A<=wma_maxlabel&&0<A){var I=La(Math.floor(v/2),Math.floor(u/2),A-1);if(lc[I]){q=u%2;lc[p]={label:[],filler:1};for(g=0;g<lc[I].label.length;g++)Math.floor(lc[I].label[g].tx/
64)===u%2&&Math.floor(lc[I].label[g].ty/64)===v%2&&(q=jQuery.extend(!0,{},lc[I].label[g]),q.tx=2*(q.tx+q.fx)-u%2*128,q.ty=2*(q.ty+q.fy)-v%2*128,q.fx=q.tx-Math.floor(q.tx),q.fy=q.ty-Math.floor(q.ty),q.tx=Math.floor(q.tx),q.ty=Math.floor(q.ty),lc[p].label.push(q));a(l.span,lc[p].label)}}(function(J,t,ca){l.xhr=$.ajax({url:t,context:l}).success(function(y){try{lc[J]=JSON.parse(y),ca?a(this.span,lc[J].label):b(this,lc[J].label)}catch(ea){this.span.html(y)}}).error(function(){this.span.text("")})})(p,
x,A<wma_maxlabel)}else A<wma_maxlabel?a(l.span,lc[p].label):b(l,lc[p].label)}}Ma(P);for(x=0;x<Na.length;++x)Ma(Na[x]);wma_highzoom_purge=!1;A>=wma_bldg3dzoom&&update3dBuildings();ja()}function W(a){a.clearColor(0,0,0,0);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthMask(!0);a.depthFunc(a.LEQUAL);a.clear(a.COLOR_BUFFER_BIT+a.DEPTH_BUFFER_BIT);var b=a.createProgram(),c=a.createShader(a.VERTEX_SHADER);a.shaderSource(c,$("#bldg-vs").text());a.compileShader(c);a.attachShader(b,c);c=a.createShader(a.FRAGMENT_SHADER);
a.shaderSource(c,$("#bldg-fs").text());a.compileShader(c);a.attachShader(b,c);a.linkProgram(b);a.useProgram(b);b.vertexPosAttrib=a.getAttribLocation(b,"pos");a.enableVertexAttribArray(b.vertexPosAttrib);b.normalPosAttrib=a.getAttribLocation(b,"norm");a.enableVertexAttribArray(b.normalPosAttrib);var f=a.getUniformLocation(b,"u_resolution"),k=a.getUniformLocation(b,"u_centerdeg");c=a.getUniformLocation(b,"u_lightdir");r=Math.sqrt(38);a.uniform3f(c,3/r,2/r,5/r);wmajt.registerWebGLBuildingData(5E3,a,
b);return function(){var w=F/2,m=E/2,d=60/(128<<A),g=ba(D+w,G+m);180<g.lon&&(g.lon-=360);a.uniform3f(f,w*d,m*d,850);a.uniform3f(k,g.lon,g.lat,0);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);wmajt.renderWebGLBuildingData()}}function sa(){function a(l){var q;if(0<u)for(m.moveTo((l[0][0]-g.lon)*v+f,k-(l[0][1]-g.lat)*v),q=1;q<l.length;q++)m.lineTo((l[q][0]-g.lon)*v+f,k-(l[q][1]-g.lat)*v);for(q=0;q<l.length-1;q++)m.moveTo((l[q][0]-g.lon)*v+f,k-(l[q][1]-g.lat)*v),m.lineTo((l[q][0]-g.lon)*p+f,k-(l[q][1]-
g.lat)*p),m.lineTo((l[q+1][0]-g.lon)*p+f,k-(l[q+1][1]-g.lat)*p)}if(X&&A>wma_bldg3dzoom){var b=wmajt.ref_z(),c=wmajt.zbuild(),f=F/2,k=E/2,w=(128<<A)/60,m=bldg3dc,d,g=ba(D+f,G+k);180<g.lon&&(g.lon-=360);m.lineWidth=.5;m.strokeStyle="rgb(0, 0, 0)";m.beginPath();bldg3dc.clearRect(0,0,F,E);for(d in b){var x=c[d].geo.coordinates;b=3*c[d].tags["building:levels"]||c[d].tags.height;var u=3*c[d].tags["building:min_level"]||c[d].tags.min_height||0;var v=w*(1+u/450);var p=w*(1+b/450);if("Polygon"===c[d].geo.type)for(d=
0;d<x.length;d++)a(x[d]);else a(x)}m.stroke();bldg3d.show();null!==bldg3dtimer&&clearTimeout(bldg3dtimer);setTimeout(update3dBuildings,1500)}else bldg3d.hide()}function Ma(a){var b=ka(a.lat,a.lon),c=b.x-D;-100>c&&(c+=256*wma_zoomsize[A]);a.obj.css("left",c-6+"px");a.obj.css("top",b.y-G-6+"px")}function Sa(a){pa=ua=ta(a)}function gb(a){a=ta(a);D+=a.x-F/2;G+=a.y-E/2;aa&&(aa=!1,ya());O();return!1}function fb(a){Oa&&clearTimeout(Oa);Fa.stop(!0).fadeTo(1,1).text(a);Oa=setTimeout(function(){Fa.fadeOut(200)},
5E3)}function Z(a){A=a;bldg3d&&(a>=wma_bldg3dzoom?bldg3d.show():bldg3d.hide())}function Va(a,b){$.ajax({url:"//tools.wmflabs.org/wiwosm/osmjson/getGeoJSON.php?lang="+a+"&article="+b,dataType:"json",success:jb})}function kb(a){var b=!1;a=a||window.event;switch(a.keyCode||a.which){case 37:D-=F/1;break;case 38:G-=E/1;break;case 39:D+=F/1;break;case 40:G+=E/1;break;case 187:case 107:Wa();break;case 189:case 109:Xa();break;case 80:wma_highzoom_purge=!0;O();break;case 79:H.shown?(H.shown=!1,H.canvas.fadeOut(200)):
Va(strings.sover[C].site,strings.sover[C].list[0]);break;case 84:va((M+1)%wma_tilesets.length);break;case 76:a="en de fr ru ar he ko ja ml fa commons".split(" ");a=a[($.inArray(R,a)+1)%a.length];Fa.text(wikiminiatlas_sites[a]);Ga(a,!0);break;case 67:Ga("commons",!0);break;case 27:H.shown&&(H.shown=!1,H.canvas.fadeOut(200));Y.shown&&Ya();"hidden"!=xa.style.visibility&&(xa.style.visibility="hidden");break;default:b=!0}aa&&(aa=!1,ya());O();return b}function ta(a){var b=a.originalEvent;return"touches"in
b?{x:b.touches[0].pageX,y:b.touches[0].pageY}:{x:a.pageX,y:a.pageY}}function La(a,b,c){return R+"_"+(wma_zoomsize[c]-a-1)+"_"+b%(2*wma_zoomsize[c])+"_"+c+"_"+wma_tilesets[M].globe}function Ua(a,b,c){return wma_database+"?l="+R+"&a="+(wma_zoomsize[c]-a-1)+"&b="+b%(2*wma_zoomsize[c])+"&z="+c+"&g="+wma_tilesets[M].globe}function Wa(a){var b=ba(D+F/2,G+E/2),c=!1;a||(a=window.event);a&&(a.which?c=3==a.which:a.button&&(c=2==a.button));c?X&&wma_highzoom_activated?Z(0==M?15:wma_tilesets[M].maxzoom):Z(0==
M?12:wma_tilesets[M].maxzoom):A>=(0!=M||X&&wma_highzoom_activated?wma_tilesets[M].maxzoom:12)||Z(A+1);a=aa?ka(P.lat,P.lon):ka(b.lat,b.lon);D=a.x-F/2;G=a.y-E/2;O();return!1}function Xa(a){var b=ba(D+F/2,G+E/2),c=!1;a||(a=window.event);a&&(a.which?c=3==a.which:a.button&&(c=2==a.button));if(c)Z(wma_tilesets[M].minzoom);else if(A<=wma_tilesets[M].minzoom)a:for(a=M-1;0<=a;a--){if(wma_tilesets[a].minzoom<A-1){M=a;A--;break a}}else Z(A-1);b=ka(b.lat,b.lon);D=b.x-F/2;G=b.y-E/2;O();return!1}function va(a,
b){var c=A;M=a;Ka={color:wma_tilesets[a].linkcolor[0],textShadow:wma_tilesets[a].linkcolor[1]};$("a.label").css(Ka);credit.text("");"credit"in wma_tilesets[a]&&credit.html(wma_tilesets[a].credit);c>(0!=a?wma_tilesets[a].maxzoom:X&&wma_highzoom_activated?15:12)&&(c=wma_tilesets[a].maxzoom);c<wma_tilesets[a].minzoom&&(c=wma_tilesets[a].minzoom);A!=c&&(a=ba(D+F/2,G+E/2),Z(c),c=ka(a.lat,a.lon),D=c.x-F/2,G=c.y-E/2);b||O();Za()}function Ga(a){R=a;for(a=0;a<ha*ma;++a)ia[a].url="";O()}function ib(){var a=
ba(D+F/2,G+E/2);var b=Math.cos(.0174532778*a.lat)*wma_tilesets[M].equator*50/(256*wma_zoomsize[A]);a=Math.pow(10,Math.floor(Math.log(b)/Math.log(10)));b=50*a/b;50>5*b&&(b*=5,a*=5);50>2*b&&(b*=2,a*=2);$a.text(1>a?1E3*a+" m":a+" km");ab.width(b)}function ya(){aa?$("#button_target").css("background-position",""):$("#button_target").css("background-position","-40px 0")}function Pa(a,b){a=ka(a,b);D=a.x-F/2;G=a.y-E/2;O()}function lb(){Pa(P.lat,P.lon);aa=!0;ya()}function za(a,b,c){c=c||128*wma_zoomsize[A];
return{y:Math.floor((.5-a/180)*c),x:Math.floor(b/360*c*2)}}function ka(a,b,c){c=c||128*wma_zoomsize[A];b=Math.floor(b/360*c*2);0>b&&(b+=2*c);return{y:Math.floor((.5-a/180)*c),x:b}}function ba(a,b){return{lat:180*(.5-b/(128*wma_zoomsize[A])),lon:a/(256*wma_zoomsize[A])*360}}function Ca(a,b,c){function f(w){for(let m=0;m<k.length;m++)if(w<k[m])return k[m];return w}var k=[120,150,180,200,220,250,300,400];return c?"https://upload.wikimedia.org/wikipedia/commons/thumb/"+c[0]+"/"+c+"/"+a+"/"+f(b)+"px-"+
a:"https://commons.wikimedia.org/w/thumb.php?w="+f(b)+"&f="+a}function Ya(){Y.shown=!1;Y.panel.fadeOut(200)}function hb(){Y.panel=$("<div></div>",{id:"wma_wmaci_panel"}).append($("<div></div>",{id:"wma_wmaci_panel_sub"}).append(Y.span=$("<span></span>")).append($("<br/>")).append(Y.link=$("<a></a>",{id:"wma_wmaci_link",target:"_top"}).click(function(a){a.stopPropagation()}))).css("visibility","visible").hide().click(Ya).appendTo(n)}function mb(){var a=window.open("","showwin","left=0, top=0, width="+
screen.width+", height="+screen.height+", toolbar=0, resizable=0, fullscreen=1"),b=e.page,c=e.lang,f=wma_tilesets[M].globe,k=ba(D+F/2,G+E/2);a.document.location=document.location.pathname+"?"+P.lat+"_"+P.lon+"_0_0_"+R+"_"+A+"_"+Da+"_"+k.lat+"_"+k.lon+"&globe="+f+"&page="+b+"&lang="+c}function Qa(a,b){return function(c){window.parent.postMessage(b+", "+a,"*")}}function Ra(a){X&&(a=a||z,null===a.canvas&&(a.canvas=$('<canvas class="wmakml"></canvas>').attr({width:F*L,height:E*L}).css({width:F+"px",height:E+
"px"}).appendTo($(fa)),a.c=a.canvas[0].getContext("2d"),a.c.scale(L,L),a.shown=!0,a.drawn=!0,a==z&&$("#button_kml").show()),a===z&&B&&B.updateKML())}function nb(a){a=a.originalEvent;var b=JSON.parse(a.data),c;if("coords"in b)for(c=0;c<b.coords.length;++c){var f={obj:null,lat:b.coords[c].lat,lon:b.coords[c].lon};if(1E-4<Math.abs(f.lat-P.lat)||1E-4<Math.abs(f.lon-P.lon))f.obj=$("<div></div>").attr("title",decodeURIComponent(b.coords[c].title)).addClass("emarker").mouseover(Qa(c,"highlight")).mouseout(Qa(c,
"unhighlight")).click(Qa(c,"scroll")).appendTo($(fa)),Ma(f),Na.push(f)}if("ways"in b||"areas"in b)Ra(),z.ways=b.ways||null,z.areas=b.areas||null,ja();if("minlon"in b&&"maxlon"in b){if(!("maxlon"in z)||b.maxlon>z.maxlon)z.maxlon=b.maxlon;if(!("minlon"in z)||b.minlon<z.minlon)z.minlon=b.minlon}"getcoords"in b&&(c={query:b.getcoords,response:{topleft:ba(D,G),rightbottom:ba(D+F,G+E)}},window.parent&&window.parent.postMessage(JSON.stringify(c),a.origin));"moveto"in b&&(a=b.moveto,"zoom"in a&&Z(a.zoom),
"lat"in a&&"lon"in a&&(Pa(a.lat,a.lon),B&&B.setLatLon(a.lat,a.lon)))}function bb(a,b){function c(d){var g,x=180/Math.PI,u=Math.PI/2,v=180/2.003750834E7,p=[],l=-Infinity,q=Infinity;for(g=0;g<d.length;++g){var I=d[g][0]*v;var J=x*(2*Math.atan(Math.exp(d[g][1]*v/x))-u);I>l&&(l=I);I<q&&(q=I);J>b.maxlat&&(b.maxlat=J);J<b.minlat&&(b.minlat=J);p.push({lat:J,lon:I})}"maxlon"in b&&"maxlon"in b?(d=[{r:Math.max(b.maxlon,l),l:Math.min(b.minlon,q)},{r:Math.max(b.maxlon,l+360),l:Math.min(b.minlon,q+360)},{r:Math.max(b.maxlon+
360,l),l:Math.min(b.minlon+360,q)}],d.sort(function(t,ca){return t.r-t.l-(ca.r-ca.l)}),b.minlon=d[0].l,b.maxlon=d[0].r):(b.maxlon=l,b.minlon=q);return p}function f(d){var g={outer:[],inner:[]},x;g.outer.push(c(d[0]));for(x=1;x<d.length;x++)g.inner.push(c(d[x]));b.areas?b.areas.push(g):b.areas=[g]}function k(d){d=[c(d)];b.ways?b.ways.push.apply(b.ways,d):b.ways=d}function w(d){var g;switch(d.type){case "LineString":k(d.coordinates);break;case "MultiLineString":for(g=0;g<d.coordinates.length;g++)k(d.coordinates[g]);
break;case "Polygon":f(d.coordinates);break;case "MultiPolygon":for(g=0;g<d.coordinates.length;g++)f(d.coordinates[g])}}var m;if("type"in a)if("GeometryCollection"==a.type)for(m=0;m<a.geometries.length;++m)w(a.geometries[m]);else w(a)}function ob(a){bb(a,z);if(z.ways||z.areas)Ra(),ja();if(z.maxlon&&z.minlon&&-Infinity<z.maxlat&&Infinity>z.minlat){a=(z.maxlon+z.minlon)/2;var b=(z.maxlat+z.minlat)/2,c=(z.maxlon-z.minlon)/180*384,f=(z.maxlat-z.minlat)/180*384,k;for(k=0;12>k&&!(c>F/2||f>E/2);++k)c*=2,
f*=2;Z(k);Pa(b,a)}}function jb(a){function b(m){var d,g=0;m[0].lon<H.minlon&&(g=360);for(d=0;d<m.length;++d)m[d].lon-=k-g,m[d].lon*=Math.cos(m[d].lat/180*Math.PI),m[d].lat-=w}var c=H.c,f=H.canvas;f?H={shown:!0,drawn:!1,canvas:f,c,ways:null,areas:null,maxlat:-Infinity,minlat:Infinity}:(H={shown:!0,drawn:!1,canvas:null,c:null,ways:null,areas:null,maxlat:-Infinity,minlat:Infinity},Ra(H));bb(a,H);a=H.areas;c=H.ways;var k=(H.maxlon+H.minlon)/2,w=(H.maxlat+H.minlat)/2;if(null!==a)for(i=0;i<a.length;++i){for(j=
0;j<a[i].outer.length;++j)b(a[i].outer[j]);for(j=0;j<a[i].inner.length;++j)b(a[i].inner[j])}if(null!==c)for(i=0;i<c.length;++i)latNorm(c[i]);H.canvas.fadeIn(200)}var F=500,E=300,fa=null,cb=!1,ha,ma,ia,ua=null,pa={x:-1,y:-1},D=0,G=0,A=1,db=0,P={obj:null,lat:0,lon:0},Na=[],aa=!0,xa=null,Da="de",R="",C="en",oa=!1,M=0,$a=null,ab=null,wa=null,eb=null,Y={shown:!1,panel:null,image:null,link:null};e=e||parseParams(window.location.href);var H={},z={shown:!1,drawn:!1,canvas:null,c:null,ways:null,areas:null,
maxlat:-Infinity,minlat:Infinity},Ka={},B=!1,Za=null,X="HTMLCanvasElement"in window,L="devicePixelRatio"in window?window.devicePixelRatio:1,Fa,Oa=null;(function(){var a=e.wma||window.location.search.substr(1);var b=e.page,c=e.lang;wa=e.globe||"Earth";b&&X&&$.ajax({url:"//tools.wmflabs.org/wiwosm/osmjson/getGeoJSON.php?lang="+c+"&article="+b,dataType:"json",success:ob});Za=function(){if(!X)return function(){};var d=0==M?256:128,g=$("<canvas></canvas>").attr({width:24*d/3,height:12*d/3}).css({display:"none"}),
x=$("<canvas></canvas>").attr({width:6*d,height:3*d}).css({display:"none"}),u=$("<canvas></canvas>").attr({width:6*d,height:3*d}).css({display:"none"}),v=$("<div></div>").css({position:"absolute",width:"80px",height:"80px",bottom:"20px",right:"5px",zIndex:50,display:"none",borderRadius:"40px","-moz-border-radius":"40px",boxShadow:"5px 5px 25px rgba(0, 0, 0, 0.3)"}),p=$("<canvas></canvas>").attr({width:160,height:160}).css({position:"absolute",width:"80px",height:"80px",bottom:"20px",right:"5px",zIndex:51,
display:"none"});$("body").append(p).append(g).append(v);return function(){function l(y,ea){var ra=new Image;$(ra).load(function(){t.drawImage(ra,y*d,ea*d);J++;if(18==J){ca.drawImage(x[0],0,0,24*d/3,12*d/3);if(!B){B=wmaGlobe3d(p[0],g[0]);if(!B)return;B.setLatLon(P.lat,P.lon);v.fadeIn(200);p.fadeIn(200);B.mapContext=ca;B.tmap=x[0];B.tmapContext=t;B.omap=u[0];B.omapContext=u[0].getContext("2d");B.updateTiles=function(){B.mapContext.clearRect(0,0,24*d/3,12*d/3);B.mapContext.drawImage(B.tmap,0,0,24*d/
3,12*d/3);B.updateTexture();B.draw()};B.updateKML=function(){B.mapContext.clearRect(0,0,24*d/3,12*d/3);B.mapContext.drawImage(B.tmap,0,0,24*d/3,12*d/3);B.mapContext.save();B.mapContext.globalAlpha=.5;ja(3*d,0,0,6*d,3*d,B.omapContext);B.mapContext.drawImage(B.omap,0,0,24*d/3,12*d/3);B.mapContext.restore();B.updateTexture();B.draw()}}z.canvas?B.updateKML():B.updateTiles()}}).attr("src",wma_tilesets[M].getTileURL(ea,y,0,!0))}var q,I,J=0,t=x[0].getContext("2d"),ca=g[0].getContext("2d");t.clearRect(0,
0,6*d,3*d);for(q=0;6>q;++q)for(I=0;3>I;++I)l(q,I)}}();c=/([\d+-.]+)_([\d+-.]+)_([\d]+)_([\d]+)/;c.test(a)&&(c.exec(a),P.lat=parseFloat(RegExp.$1),P.lon=parseFloat(RegExp.$2),F=$(window).width(),E=$(window).height(),c=/([\d+-.]+)_([\d+-.]+)_([\d]+)_([\d]+)_([a-z-]+)/,c.test(a)&&(c.exec(a),R=RegExp.$5),c=/([\d+-.]+)_([\d+-.]+)_([\d]+)_([\d]+)_([a-z-]+)_([\d]+)/,c.test(a)&&(c.exec(a),db=parseInt(RegExp.$6,10),Z(db),Z(Math.min(A,0!=M?wma_tilesets[M].maxzoom:X&&wma_highzoom_activated?15:12)),Z(Math.max(A,
wma_tilesets[M].minzoom))),c=/([\d+-.]+)_([\d+-.]+)_([\d]+)_([\d]+)_([a-z-]+)_([\d]+)_([a-z-]+)/,c.test(a)?(c.exec(a),Da=RegExp.$7):Da=R,c=/([\d+-.]+)_([\d+-.]+)_([\d]+)_([\d]+)_([a-z-]+)_([\d]+)_([a-z-]+)_([\d+-.]+)_([\d+-.]+)/,c.test(a)?(a=ka(RegExp.$8,RegExp.$9),aa=!1,cb=!0):(a=ka(P.lat,P.lon),aa=!0),D=a.x-F/2,G=a.y-E/2);R=R.split("-")[0];C=Da;if("co"==C||"commons"==C)C="en";oa=isRTL(C);wmajt.setUILang(C);for(m in strings)strings[m][C]||(strings[m][C]=strings[m].en);var f='<div class="bsprite" id="button_plus" title="'+
strings.zoomIn[C]+'"></div><div class="bsprite" id="button_minus" title="'+strings.zoomOut[C]+'"></div><div class="bsprite" id="button_target" title="'+strings.center[C]+'"></div><div class="bsprite" id="button_kml" title="'+strings.kml[C]+'"></div><div class="bsprite" id="button_menu" title="'+strings.settings[C]+'"></div>';f=cb?f+('<img id="button_hide" src="'+wma_imgbase+'button_hide.png" title="'+strings.close[C]+'" onclick="window.close()">'):f+('<img id="button_fs" src="'+wma_imgbase+'button_fs.png" title="'+
strings.fullscreen[C]+'">');f+='<div id="wma_map" style="position:absolute; width:'+F+"px; height:"+E+'px; cursor: move; background-color: #aaaaaa;"></div>';f+='<div id="scalebox"><div id="scalebar"></div><div id="scalelabel">null</div></div>';f+='<div id="synopsis"><p id="synopsistext"></p></div>';f+='<div id="wma_settings"><h4>'+strings.settings[C]+'</h4><p class="option">Size Comparison <select id="wmaSetSizeOverlay">';a=strings.sover[C].list;f+='<option value="-" class="bg" selected="selected">-</option>';
f+='<option value="+" class="bg">'+strings.other[C]+"</option>";f+='<option value="*" class="bg">'+decodeURIComponent(b)+"</option>";for(m in a)f+='<option value="'+a[m]+'">'+a[m]+"</option>";f+='</select></p><a href="//wma.wmflabs.org/" target="_top"><img src="//upload.wikimedia.org/wikipedia/commons/4/46/Powered_by_labs_button.png" border="0"></a></div>';n.html(f).append($("<span></span>",{id:"wmacredit"}).append($("<a></a>",{href:"//meta.wikimedia.org/wiki/WikiMiniAtlas/"+Da,target:"_top"}).text("WikiMiniAtlas")).append(credit=
$("<span></span>")));var k=new wmaMenu(oa);(function(){var d;k.addTitle(strings.labelSet[C],oa);var g='<select id="wmaLabelSet">';R in wikiminiatlas_sites&&(g+='<option value="'+R+'" selected="selected">'+wikiminiatlas_sites[R]+"</option>");R!==C&&C in wikiminiatlas_sites&&(g+='<option value="'+C+'">'+wikiminiatlas_sites[C]+"</option>");if(R in wikiminiatlas_sites||C in wikiminiatlas_sites)g+="<option disabled></option>";for(d in wikiminiatlas_sites)"commons"!==d&&(g+='<option value="'+d+'">'+wikiminiatlas_sites[d]+
"</option>");var x=k.addGroup([["LANG",g+"</select>"],["commons",strings.commons[C]]],function(p){"LANG"==p&&(p=x.items.LANG.find("select option:selected").val());Ga(p)},"commons"==R?"commons":"LANG",oa);x.items.LANG.find("select").click(function(p){p.stopPropagation()}).change(function(p){x.items.LANG.click()});k.addSep();var u={};for(d=0;d<wma_tilesets.length;++d)g=wma_tilesets[d].globe,u[g]=u[g]||[],u[g].push([d,strings[wma_tilesets[d].name][C]||""]);f='<select id="wmaGlobeSet">';for(d in u)f+=
'<option value="'+d+'"',d==wa&&(f+='selected="selected"'),f+=">"+strings["map"+d][C]+"</option>";f+="</select>";k.addTitle(strings.solarSystem[C],oa);var v=k.addItem(f,void 0,oa);v.find("select").click(function(p){p.stopPropagation()}).change(function(p){p=$(this).find("option:selected").val();u[wa].hide();u[p].show();wa=p;v.click();va(u[p].current())});k.addSep();k.addTitle(strings.mode[C],oa);for(d in u)u[d]=k.addGroup(u[d],va,u[d][0][0],oa),d!==wa&&u[d].hide(),k.addSep();k.addItem(strings.sizeRef[C],
h)})();$("#button_menu").click(function(){k.toggle()});$("#button_fs").click(mb);$("#wma_widget").append(k.div.css({right:"40px",top:"26px"}));a=strings.dyk[C];var w=$("<div></div>").html(a[Math.floor(Math.random()*a.length)]).addClass("news");Fa=$("<div></div>").css({position:"absolute",top:"30px",left:"60px",zIndex:100,fontSize:"40px",color:"white",textShadow:"1px 1px 5px black",fontWeight:"bold"}).appendTo("#wma_widget");wmaNews[0]=function(){va(4)};wmaNews[1]=function(){X?(D=19039255,G=3363704,
Z(15),va(0)):w.text("Sorry, your browser does not support the canvas element! Try FireFox or Google Chrome.")};$("#wma_widget").append(w);w.click(function(){w.fadeOut()});setTimeout(function(){w.fadeOut()},1E4);$a=$("#scalelabel");ab=$("#scalebar");document.getElementById("button_target");xa=document.getElementById("wma_settings");$("#wmaLabelSet").change(function(){Ga(this.value)});$("#wmaSetSizeOverlay").change(function(){a:{var d=strings.sover[C].site,g=this.value;if("+"==g&&(g=prompt("Enter article title to use as overlay"),
!g))break a;"*"==g&&(g=e.page,d=e.lang);"-"==g?(H.shown=!1,H.canvas.fadeOut(200)):(Va(d,g),h())}});$("#button_plus").on("mousedown",Wa);$("#button_minus").on("mousedown",Xa);$("#button_target").on("click",lb);$("#button_kml").on("click",T);$(document).on("keydown",kb);$(document).on("contextmenu",function(){return!1});$("body").on("dragstart",function(){return!1});$("#wma_map").click(function(d){d=ta(d);if(d.x!=pa.x||d.y!=pa.y)return!1});S();bldg3d=$('<canvas class="wmakml"></canvas>').attr({width:F*
L,height:E*L}).css({zIndex:19,opacity:.75,width:F+"px",height:E+"px"}).appendTo($(fa));if(X){try{bldg3dc=bldg3d[0].getContext("experimental-webgl"),update3dBuildings=W(bldg3dc)}catch(d){bldg3dc=null,bldg3d.remove(),bldg3d=$('<canvas class="wmakml"></canvas>').attr({width:F*L,height:E*L}).css({zIndex:19,opacity:.75,width:F+"px",height:E+"px"}).appendTo($(fa))}bldg3dc&&!1!==update3dBuildings||(bldg3dc=bldg3d[0].getContext("2d"),bldg3dc.scale(L,L),update3dBuildings=sa)}$(window).resize(na);var m;for(m=
0;m<wma_tilesets.length&&wma_tilesets[m].globe!=wa;++m);va(m,!0);O();ya();eb=/https?:\/\/([a-z-]+)\.wikipedia\.org\/wiki\/(.*)/;$("#wma_widget").mouseover(function(d){if(d.metaKey||d.ctrlKey)if(d.target.href&&eb.test(d.target.href)){d=RegExp.$1;var g=RegExp.$2;$.getJSON("https://"+d+".wikipedia.org/api/rest_v1/page/summary/"+g,x=>{$("#synopsistext").css({direction:x.dir,"padding-left":"0.5em","padding-right":"0.5em"}).html(x.extract_html);if("thumbnail"in x){var u=new Image,v=x.thumbnail.width/2,
p=x.thumbnail.height/2,l="ltr"==x.dir?"left":"right";$(u).css({width:v+"px",height:p+"px",position:"absolute",bottom:"0.5em"}).css(l,"10px").load(()=>{$("#synopsistext").css("padding-"+l,v+20+"px").append($(u))}).attr("src",x.thumbnail.source)}$("#synopsis").fadeIn("slow");setTimeout(function(){var q=$("#synopsistext").outerHeight(!0),I=E/2;$("#synopsis").animate({height:q<I?q:I})},500)})}else $("#synopsis").fadeOut("fast")});$("#synopsis").click(function(d){d.target==this&&$("#synopsis").fadeOut("fast")});
if(window.postMessage&&($(window).on("message",nb),window!=window.top))try{window.parent.postMessage("request","*")}catch(d){}})()}function wmaMenu(n){this.div=$("<div></div>").addClass("wmamenu").css("direction",!0===n?"rtl":"");this.parent=null;this.shown=!1}wmaMenu.prototype.addTitle=function(n,e){return $("<div></div>").addClass("wmamenutitle").html(n).css("direction",!0===e?"rtl":"").appendTo(this.div)};
wmaMenu.prototype.addItem=function(n,e,h){e=e||function(){};var N=this,S=$("<div></div>").addClass("wmamenuitem").html(n).css("direction",!0===h?"rtl":"").mouseenter(function(){S.css("background-color","#AAA")}).mouseleave(function(){S.css("background-color","")}).click(function(){e();N.close()}).appendTo(this.div);return S};
wmaMenu.prototype.addMenu=function(n,e,h){var N=$("<div></div>").addClass("wmasubmenu").html(n).css("direction",!0===h?"rtl":"").mouseenter(function(){N.css("background-color","#AAA")}).mouseleave(function(){N.css("background-color","");e.hide()}).click(function(){e.move(N.width(),0);e.show()}).append(e.div).appendTo(this.div);e.parent=this;return N};
wmaMenu.prototype.addCheck=function(n,e,h,N){function S(){h?na.addClass("wmamenuchecked"):na.removeClass("wmamenuchecked")}var na=this.addItem(n,function(){h=!h;S();e(h)},N);e=e||function(){};S();return{toggle:function(T){void 0===T&&(h=!h,S())},check:S,item:na}};
wmaMenu.prototype.addGroup=function(n,e,h,N){function S(W){if(W!=ja){for(var sa in T)sa==W?T[sa].addClass("wmamenuselected"):T[sa].removeClass("wmamenuselected");ja=W}}function na(W,sa){T[W]=Ha.addItem(sa,function(){S(W);e(W)},N)}var T={},Ha=this,ja=-1;h=h||0;e=e||function(){};for(var O=0;O<n.length;++O)"object"===typeof n[O]?na(n[O][0],n[O][1]):na(O,n[O]);S(h);return{items:T,select:S,current:function(){return ja},hide:function(){for(var W in T)T[W].hide()},show:function(){for(var W in T)T[W].show()}}};
wmaMenu.prototype.addSep=function(){this.div.children().last().css({"border-bottom-style":"solid","border-bottom-width":"1px","border-bottom-color":"#AAA"})};wmaMenu.prototype.show=function(){this.div.fadeIn(200);this.shown=!0};wmaMenu.prototype.hide=function(){this.div.fadeOut(200);this.shown=!1};wmaMenu.prototype.toggle=function(){this.shown?this.hide():this.show()};wmaMenu.prototype.close=function(){this.hide();this.parent&&this.parent.close()};
wmaMenu.prototype.move=function(n,e){this.div.css({top:e+"px",left:n+"px"})};
